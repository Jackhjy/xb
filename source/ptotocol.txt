

固定帧格式
----------------------------------------------------
--启动字符 10H
----------------------------------------------------
--控制域    （C）
----------------------------------------------------
--地址域    （A）高8位 暂时未用
----------------------------------------------------
--地址域    （A）高8位 暂时未用
----------------------------------------------------
--地址域    （A）低8位 暂时未用
----------------------------------------------------
--地址域    （A）低8位 暂时未用
----------------------------------------------------
--结束字符   16H



可变帧格式
----------------------------------------------------
--启动字符  68H
----------------------------------------------------
--长度        L高8位（用户数据的数据长度）
----------------------------------------------------
--长度        L低8位
----------------------------------------------------
--包计数      L高8位（同一个文件的第几个包）
----------------------------------------------------
--包计数      L高8位
----------------------------------------------------
--包计数      L低8位
----------------------------------------------------
--包计数      L低8位
----------------------------------------------------
--启动字符串 68H
----------------------------------------------------
--控制域       （C)
----------------------------------------------------
--地址域    （A）高8位 暂时未用
----------------------------------------------------
--地址域    （A）高8位 暂时未用
----------------------------------------------------
--地址域    （A）低8位 暂时未用
----------------------------------------------------
--地址域    （A）低8位 暂时未用
----------------------------------------------------
--用户数据      （可变长度）
----------------------------------------------------
--帧校验和      （CS）这里暂时不作校验，但保留该位
----------------------------------------------------
--结束字符串     （16H）
----------------------------------------------------

控制域（C）：
（1）Client(XB主站)---------->Host（数据收集主站）
<0>:表示命令无效
<1-15>:暂时保留
<16-18>:文件传输命令
    <16>:请求开始传输文件命令
    <17>:正在传输文件
    <18>:请求文件传输终止或已经完成文件的传输
    
（2）Host（数据收集主站）---------->Client(XB主站)
<0>:表示命令无效
<1-15>:暂时保留
<16-20>:文件传输命令
    <16>:确认开始传输文件命令
    <17>:文件传输正确，请下位机继续传输
    <18>:当前文件包传输错误，重传
    <19>:响应文件传输终止或已经完成文件的传输
    <20>:结束该文件的传输
    <21>:忙，等待一段时间再请求
    
    
    
通信过程描述：
C:表示客户端
H:表示主站

         请求开始传输文件命令(16)固定帧
C---------------------------------------->>>H

         确认开始传输文件命令(16)固定帧
C<<<----------------------------------------H
         忙，等待一段时间再请求（21）固定帧
         
         如果确认可以传输则开始传输（17）可变帧
C---------------------------------------->>>H

         确认收到的数据正确，接着下一个传输（17）
C<<<----------------------------------------H
         重传（18） 结束该文件传输（20）
         
         
         
         
-----------------        
--服务端处理流程--
-----------------2016/07/21
Handler类的handle函数的工作流程：
while循环内：
         接收数据
         if 接收到数据：
                  解析数据获得控制命令（parse_message()函数）
                  根据控制命令调用相应的处理函数
                  获得相应的响应数据，返回给对端客户机