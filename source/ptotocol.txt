

固定帧格式
----------------------------------------------------
--启动字符 10H
----------------------------------------------------
--控制域    （C）
----------------------------------------------------
--地址域    （A）高8位 暂时未用
----------------------------------------------------
--地址域    （A）高8位 暂时未用
----------------------------------------------------
--地址域    （A）低8位 暂时未用
----------------------------------------------------
--地址域    （A）低8位 暂时未用
----------------------------------------------------
--结束字符   16H



可变帧格式
----------------------------------------------------
--启动字符  68H
----------------------------------------------------
--长度        L高8位（用户数据的数据长度）
----------------------------------------------------
--长度        L低8位
----------------------------------------------------
--包计数      L高8位（同一个文件的第几个包）
----------------------------------------------------
--包计数      L高8位
----------------------------------------------------
--包计数      L低8位
----------------------------------------------------
--包计数      L低8位
----------------------------------------------------
--启动字符串 68H
----------------------------------------------------
--控制域       （C)
----------------------------------------------------
--地址域    （A）高8位 暂时未用
----------------------------------------------------
--地址域    （A）高8位 暂时未用
----------------------------------------------------
--地址域    （A）低8位 暂时未用
----------------------------------------------------
--地址域    （A）低8位 暂时未用
----------------------------------------------------
--用户数据      （可变长度）
----------------------------------------------------
--帧校验和      （CS）这里暂时不作校验，但保留该位
----------------------------------------------------
--结束字符串     （16H）
----------------------------------------------------

控制域（C）：
（1）Client(XB主站)---------->Host（数据收集主站）
<0>:表示命令无效
<1-15>:系统保留
    <1>:表示XB主站开始发起连接Host
<16-25>:文件传输命令
    <17>:请求开始传输文件命令
    <18>:正在传输文件
    <19>:请求文件传输终止或已经完成文件的传输
    
    <21>:表示客户机在读取文件的时候错误
    
（2）Host（数据收集主站）---------->Client(XB主站)
<0>:表示命令无效
<1-15>:系统保留
    <1>:表示Host确认来自XB主站的连接
<16-25>:文件传输命令
    <17>:确认开始传输文件命令
    <18>:文件传输正确，请下位机继续传输
    <19>:当前文件包传输错误，重传
    <20>:响应文件传输终止或已经完成文件的传输
    <21>:是否有下一个文件的传输
    <22>:忙，等待一段时间再请求
    
    
    
通信过程描述：
C:表示客户端
H:表示主站

         请求开始传输文件命令(17)可变帧
C---------------------------------------->>>H
                                             主机确认该文件是否存在，不存在则确认（17），存在则取消（20）
         确认开始传输文件命令(17)或取消（19）固定帧
C<<<----------------------------------------H
         忙，等待一段时间再请求（22）固定帧
         
         如果确认可以传输则开始传输（18）可变帧
C---------------------------------------->>>H

         确认收到的数据正确，接着下一个传输（18）
C<<<----------------------------------------H
         重传（19） 结束该文件传输（20）
         
         
         
         
-----------------        
--服务端处理流程--
-----------------2016/07/21
Handler类的handle函数的工作流程：
while循环内：
         接收数据
         if 接收到数据：
                  解析数据获得控制命令（parse_message()函数）
                  根据控制命令调用相应的处理函数
                  获得相应的响应数据，返回给对端客户机
                  






帧的类型有：
发送帧------》确认帧
请求帧------》响应帧



##客户端程序设计
1.准备采用分层设计，从里到外的设计方式

client------>object
         --->传输文件只是一种功能
         --->构造一种连接主站的方法（connect），可以在以后的连接方式有变化的情况之下修改
         --->
         
run方法：
def run():
         while:
                  等待接收主站下发的数据命令
                  if 接收到数据：
                           解析获得的数据命令
                           if 命令有效：
                                    执行处理程序handler
                           else 命令无效：
                  else 未接收到数据：
                           重新连接主站
handle方法：
def handle():
         if cmd==CMD.xxxx:
                  根据不同解析包来获得不同的处理方式
                  

客户端进程里面的通信管道传输的内容格式：

queue_task:字典格式{'file':filepath}

配置文件的文件路径格式统一为：'c:\\asfasf'而不是'c:\\asdfasfd\\'
